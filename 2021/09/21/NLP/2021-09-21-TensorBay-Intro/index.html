<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  
  <meta name="description" content="AI | NLP | 人工智能 | 哲学 | 自然语言处理 | 机器学习" />
  

  
  
  
  
  
  <title>TensorBay 指南 | Yam</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Introduction本篇文章主要介绍如何使用 Tensorbay 和 Tensorflow 进行简单的文本分类。 我们首先介绍 Tensorbay 相关使用，然后简单介绍 NLP 领域常用的分类模型：TextCNN，最后将所有的串起来完成一个简单的文本分类任务。">
<meta name="keywords" content="AI,TextCNN,NLP,TensorBay,Tensorflow">
<meta property="og:type" content="article">
<meta property="og:title" content="TensorBay 指南">
<meta property="og:url" content="https://www.yam.gift/2021/09/21/NLP/2021-09-21-TensorBay-Intro/index.html">
<meta property="og:site_name" content="Yam">
<meta property="og:description" content="Introduction本篇文章主要介绍如何使用 Tensorbay 和 Tensorflow 进行简单的文本分类。 我们首先介绍 Tensorbay 相关使用，然后简单介绍 NLP 领域常用的分类模型：TextCNN，最后将所有的串起来完成一个简单的文本分类任务。">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://qnimg.lovevivian.cn/paper-textcnn-1.jpg">
<meta property="og:updated_time" content="2021-10-16T14:52:48.839Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="TensorBay 指南">
<meta name="twitter:description" content="Introduction本篇文章主要介绍如何使用 Tensorbay 和 Tensorflow 进行简单的文本分类。 我们首先介绍 Tensorbay 相关使用，然后简单介绍 NLP 领域常用的分类模型：TextCNN，最后将所有的串起来完成一个简单的文本分类任务。">
<meta name="twitter:image" content="http://qnimg.lovevivian.cn/paper-textcnn-1.jpg">
  
  
    <link rel="icon" href="/css/images/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css">
  

  
  <!-- baidu webmaster push -->
<link rel="alternate" href="/atom.xml" title="Yam" type="application/atom+xml"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body class="home blog custom-background custom-font-enabled single-author">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="page" class="hfeed site">
      <header id="masthead" class="site-header" role="banner">
    <hgroup>
      <h1 class="site-title">
        <a href="/" title="Yam" rel="home">Yam</a>
      </h1>
      
        <h2 class="site-description">
          <a href="/" id="subtitle">Feeling, Coding, Thinking</a>
        </h2>
      
    </hgroup>

    <nav id="site-navigation" class="main-navigation" role="navigation">
            <button class="menu-toggle">菜单</button>
            <a class="assistive-text" href="/#content" title="跳至内容">跳至内容</a><!--TODO-->
            <div class="menu-main-container">
                <ul id="menu-main" class="nav-menu">
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/">Home</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/series/">Series</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/archives/">Archives</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/about/">About</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://github.com/hscspring">Projects</a></li>
                
                </ul>
            </div>
    </nav>
</header>
      <div id="main" class="wrapper">
        <div id="primary" class="site-content"><div id="content" role="main"><article id="post-NLP/2021-09-21-TensorBay-Intro" class="post-NLP/2021-09-21-TensorBay-Intro post type-post status-publish format-standard hentry">
    <!---->

      <header class="entry-header">
        
        
  
    <h1 class="entry-title article-title">
      TensorBay 指南
    </h1>
  

        
        <!-- <div class="comments-link">
            
            <a href="javascript:void(0);" data-url="https://www.yam.gift/2021/09/21/NLP/2021-09-21-TensorBay-Intro/" data-id="cl4jbzeu5004tlrbzs4z750jp" class="leave-reply bdsharebuttonbox" data-cmd="more">undefined</a>
        </div> --><!-- .comments-link -->
      </header><!-- .entry-header -->

    <div class="entry-content">
      
            <!-- Table of Contents -->
              
        <h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>本篇文章主要介绍如何使用 Tensorbay 和 Tensorflow 进行简单的文本分类。</p>
<p>我们首先介绍 Tensorbay 相关使用，然后简单介绍 NLP 领域常用的分类模型：TextCNN，最后将所有的串起来完成一个简单的文本分类任务。</p>
<a id="more"></a>
<h2 id="TensorBay"><a href="#TensorBay" class="headerlink" title="TensorBay"></a>TensorBay</h2><p>TensorBay 是什么？借用官方的介绍：</p>
<blockquote>
<p>作为非结构化数据管理专家，TensorBay 提供数据托管、复杂数据版本管理、在线数据可视化和数据协作等服务。 TensorBay 的统一权限管理，让您的数据共享和协同使用更加安全。</p>
</blockquote>
<p>简单来说，它提供了统一的数据集管理方案。官方提供了 Python SDK，用于：</p>
<ul>
<li>通过 Pythonic 的方式访问数据资源</li>
<li>易于使用的 CLI 工具</li>
<li>统一的数据集结构</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 本地与 TensorBay 服务器交互的客户端</span></span><br><span class="line"><span class="keyword">from</span> tensorbay <span class="keyword">import</span> GAS</span><br><span class="line"><span class="comment"># Segment 用于分割数据集的不同部分</span></span><br><span class="line"><span class="keyword">from</span> tensorbay.dataset <span class="keyword">import</span> Segment</span><br><span class="line"><span class="comment"># Dataset 数据集工具，包含一系列的 Segment</span></span><br><span class="line"><span class="keyword">from</span> tensorbay.dataset <span class="keyword">import</span> Dataset <span class="keyword">as</span> TensorBayDataset</span><br><span class="line"><span class="comment"># Note 信息</span></span><br><span class="line"><span class="keyword">from</span> tensorbay.dataset <span class="keyword">import</span> Notes</span><br><span class="line"><span class="comment"># 内置的 Newsgroup20 数据集</span></span><br><span class="line"><span class="keyword">from</span> tensorbay.opendataset <span class="keyword">import</span> Newsgroups20</span><br></pre></td></tr></table></figure>
<h3 id="GAS"><a href="#GAS" class="headerlink" title="GAS"></a>GAS</h3><p>首先，需要在官方网站注册一个账号：<a href="https://gas.graviti.cn/tensorbay/" target="_blank" rel="noopener">https://gas.graviti.cn/tensorbay/</a></p>
<p>登陆后，在【开发者工具】里面的【AccessKey】中新建一个 Key，就可以用于连接 TensorBay 了。</p>
<p>创建 GAS 后，之后的操作就都基于该账号进行。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">access_key = <span class="string">"&lt;YOUR_ACCESS_KEY&gt;"</span></span><br><span class="line">gas = GAS(access_key)</span><br></pre></td></tr></table></figure>
<h3 id="TensorBayDataset"><a href="#TensorBayDataset" class="headerlink" title="TensorBayDataset"></a>TensorBayDataset</h3><p>一般会在此定义数据集，当然官方也内置了一些数据集。数据集结构如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">dataset</span><br><span class="line">├── notes</span><br><span class="line">├── catalog</span><br><span class="line">│   ├── subcatalog</span><br><span class="line">│   ├── subcatalog</span><br><span class="line">│   └── ...</span><br><span class="line">├── segment</span><br><span class="line">│   ├── data</span><br><span class="line">│   ├── data</span><br><span class="line">│   └── ...</span><br><span class="line">├── segment</span><br><span class="line">│   ├── data</span><br><span class="line">│   ├── data</span><br><span class="line">│   └── ...</span><br><span class="line">└── ...</span><br></pre></td></tr></table></figure>
<ul>
<li>dataset：最顶层的概念，每个数据集包括一个目录和一些 Segment，对应的 class 是 <code>Dataset</code></li>
<li>notes：包含一个数据集的基本信息，对应的 class 是 <code>Notes</code>，包括：<ul>
<li>数据集中数据的时间连续性</li>
<li>数据集中的 bin 点云文件的字段</li>
</ul>
</li>
<li><p>catalog：用于存储标签元信息，它收集与数据集对应的所有标签，一个目录下可以有一个或多个子目录（标签格式），每个子目录只存储一种标签类型的标签元信息，包括对应的注解是否有跟踪信息。<strong>注意：如果没有标签信息，则不需要 catalog</strong></p>
<p>以 BSTLD 数据集（Box2D 为 label）为例，它的 catalog 如下所示：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"BOX2D"</span>: &#123;</span><br><span class="line">      <span class="attr">"categories"</span>: [</span><br><span class="line">          &#123; <span class="attr">"name"</span>: <span class="string">"Red"</span> &#125;,</span><br><span class="line">          &#123; <span class="attr">"name"</span>: <span class="string">"RedLeft"</span> &#125;,</span><br><span class="line">          &#123; <span class="attr">"name"</span>: <span class="string">"RedRight"</span> &#125;,</span><br><span class="line">          &#123; <span class="attr">"name"</span>: <span class="string">"RedStraight"</span> &#125;,</span><br><span class="line">          &#123; <span class="attr">"name"</span>: <span class="string">"RedStraightLeft"</span> &#125;,</span><br><span class="line">          &#123; <span class="attr">"name"</span>: <span class="string">"Green"</span> &#125;,</span><br><span class="line">          &#123; <span class="attr">"name"</span>: <span class="string">"GreenLeft"</span> &#125;,</span><br><span class="line">          &#123; <span class="attr">"name"</span>: <span class="string">"GreenRight"</span> &#125;,</span><br><span class="line">          &#123; <span class="attr">"name"</span>: <span class="string">"GreenStraight"</span> &#125;,</span><br><span class="line">          &#123; <span class="attr">"name"</span>: <span class="string">"GreenStraightLeft"</span> &#125;,</span><br><span class="line">          &#123; <span class="attr">"name"</span>: <span class="string">"GreenStraigntRight"</span> &#125;,</span><br><span class="line">          &#123; <span class="attr">"name"</span>: <span class="string">"Yellow"</span> &#125;,</span><br><span class="line">          &#123; <span class="attr">"name"</span>: <span class="string">"off"</span> &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"attributes"</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="attr">"name"</span>: <span class="string">"occluded"</span>,</span><br><span class="line">              <span class="attr">"type"</span>: <span class="string">"boolean"</span></span><br><span class="line">          &#125;</span><br><span class="line">      ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>segment：数据集的不同部分，每个部分存在一个 Segment 中，比如训练集、测试集，对应的 class 是 <code>Segment</code></p>
</li>
<li>data：一个 Data 包含一个数据集样本和对应的标签，以及其他任何信息（如时间戳），对应的 class 是 <code>Data</code></li>
</ul>
<h3 id="公开数据集"><a href="#公开数据集" class="headerlink" title="公开数据集"></a>公开数据集</h3><p>在 TensorBay 公开数据集平台找到想要的数据集，然后 fork。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加载一个 fork 后的公开数据集</span></span><br><span class="line">news = TensorBayDataset(<span class="string">"Newsgroups20"</span>, gas)</span><br><span class="line"><span class="comment"># 包括四个 Segment</span></span><br><span class="line">news</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Dataset("Newsgroups20") [</span></span><br><span class="line"><span class="string">  Segment("20_newsgroups") [...],</span></span><br><span class="line"><span class="string">  Segment("20news-18828") [...],</span></span><br><span class="line"><span class="string">  Segment("20news-bydate-test") [...],</span></span><br><span class="line"><span class="string">  Segment("20news-bydate-train") [...]</span></span><br><span class="line"><span class="string">]</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>
<p>四个 Segment 分别表示：</p>
<ul>
<li><code>20_newsgroups</code>：Ver1.0，原始的 20 Newsgroups 数据集</li>
<li><code>20news-bydate-*</code>：Ver2.0，根据 date 排序，并删除了重复项和一些标题</li>
<li><code>20news-18828</code>：Ver3.0，只包括发件人和主题两个标题</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 分类的类型</span></span><br><span class="line">news.catalog.classification.categories</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">NameList [</span></span><br><span class="line"><span class="string">  CategoryInfo("alt.atheism"),</span></span><br><span class="line"><span class="string">  CategoryInfo("comp.graphics"),</span></span><br><span class="line"><span class="string">  CategoryInfo("comp.os.ms-windows.misc"),</span></span><br><span class="line"><span class="string">  CategoryInfo("comp.sys.ibm.pc.hardware"),</span></span><br><span class="line"><span class="string">  CategoryInfo("comp.sys.mac.hardware"),</span></span><br><span class="line"><span class="string">  CategoryInfo("comp.windows.x"),</span></span><br><span class="line"><span class="string">  CategoryInfo("misc.forsale"),</span></span><br><span class="line"><span class="string">  CategoryInfo("rec.autos"),</span></span><br><span class="line"><span class="string">  CategoryInfo("rec.motorcycles"),</span></span><br><span class="line"><span class="string">  CategoryInfo("rec.sport.baseball"),</span></span><br><span class="line"><span class="string">  CategoryInfo("rec.sport.hockey"),</span></span><br><span class="line"><span class="string">  CategoryInfo("sci.crypt"),</span></span><br><span class="line"><span class="string">  CategoryInfo("sci.electronics"),</span></span><br><span class="line"><span class="string">  CategoryInfo("sci.med"),</span></span><br><span class="line"><span class="string">  ... (5 items are folded),</span></span><br><span class="line"><span class="string">  CategoryInfo("talk.religion.misc")</span></span><br><span class="line"><span class="string">]</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>
<h3 id="本地数据集"><a href="#本地数据集" class="headerlink" title="本地数据集"></a>本地数据集</h3><p>或者，也可以使用自定义的数据集，比如我们把 20news-18828 数据集下载到本地：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">tree . -L 2</span><br><span class="line">.</span><br><span class="line">└── 20news-18828</span><br><span class="line">    ├── alt.atheism</span><br><span class="line">    ├── comp.graphics</span><br><span class="line">    ├── comp.os.ms-windows.misc</span><br><span class="line">    ├── comp.sys.ibm.pc.hardware</span><br><span class="line">    ├── comp.sys.mac.hardware</span><br><span class="line">    ├── comp.windows.x</span><br><span class="line">    ├── misc.forsale</span><br><span class="line">    ├── rec.autos</span><br><span class="line">    ├── rec.motorcycles</span><br><span class="line">    ├── rec.sport.baseball</span><br><span class="line">    ├── rec.sport.hockey</span><br><span class="line">    ├── sci.crypt</span><br><span class="line">    ├── sci.electronics</span><br><span class="line">    ├── sci.med</span><br><span class="line">    ├── sci.space</span><br><span class="line">    ├── soc.religion.christian</span><br><span class="line">    ├── talk.politics.guns</span><br><span class="line">    ├── talk.politics.mideast</span><br><span class="line">    ├── talk.politics.misc</span><br><span class="line">    └── talk.religion.misc</span><br><span class="line"></span><br><span class="line">21 directories, 0 files</span><br></pre></td></tr></table></figure>
<p>正好 20 个类别。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看样本，一个文件对应一个样本</span></span><br><span class="line">!head <span class="number">-20</span> data/<span class="number">20</span>news<span class="number">-18828</span>/talk.religion.misc/<span class="number">84277</span></span><br></pre></td></tr></table></figure>
<pre><code>From: bd@fluent@dartmouth.EDU (Brice Dowaliby)
Subject: Re: Who&#39;s next?  Mormons and Jews?

dic5340@hertz.njit.edu (David Charlap) writes:

&gt;Someone in the government actually believed Koresh knew the &quot;seven
&gt;seals of the apocalypse&quot;, and ordered the invasion so that they&#39;d all
&gt;be dead and unable to talk about them in public.

Everything we need to know about the seven seals is already
in the bible.  There is no &quot;knowledge&quot; of the seals that
Koresh could have.

Unless the FBI were to kill all publishers of the bible, it
would seem the story of the seven seals would be bound to
leak out.

Assuming for the moment that the FBI believed in the bible and 
were afraid of the seven seals, then they would also know
that God is the one who has to open the seals, not some
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 直接把 data 目录加载进来</span></span><br><span class="line">ds = Newsgroups20(<span class="string">"./data/"</span>)</span><br><span class="line">ds</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Dataset("Newsgroups20") [</span></span><br><span class="line"><span class="string">  Segment("20news-18828") [...]</span></span><br><span class="line"><span class="string">]</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 正好 20 个</span></span><br><span class="line">ds.catalog.classification.categories</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">NameList [</span></span><br><span class="line"><span class="string">  CategoryInfo("alt.atheism"),</span></span><br><span class="line"><span class="string">  CategoryInfo("comp.graphics"),</span></span><br><span class="line"><span class="string">  CategoryInfo("comp.os.ms-windows.misc"),</span></span><br><span class="line"><span class="string">  CategoryInfo("comp.sys.ibm.pc.hardware"),</span></span><br><span class="line"><span class="string">  CategoryInfo("comp.sys.mac.hardware"),</span></span><br><span class="line"><span class="string">  CategoryInfo("comp.windows.x"),</span></span><br><span class="line"><span class="string">  CategoryInfo("misc.forsale"),</span></span><br><span class="line"><span class="string">  CategoryInfo("rec.autos"),</span></span><br><span class="line"><span class="string">  CategoryInfo("rec.motorcycles"),</span></span><br><span class="line"><span class="string">  CategoryInfo("rec.sport.baseball"),</span></span><br><span class="line"><span class="string">  CategoryInfo("rec.sport.hockey"),</span></span><br><span class="line"><span class="string">  CategoryInfo("sci.crypt"),</span></span><br><span class="line"><span class="string">  CategoryInfo("sci.electronics"),</span></span><br><span class="line"><span class="string">  CategoryInfo("sci.med"),</span></span><br><span class="line"><span class="string">  ... (5 items are folded),</span></span><br><span class="line"><span class="string">  CategoryInfo("talk.religion.misc")</span></span><br><span class="line"><span class="string">]</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>
<p>这里，只需要将数据集按指定的格式和目录放置即可，要求如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;path&gt;</span><br><span class="line">    20news-18828/</span><br><span class="line">        alt.atheism/</span><br><span class="line">            49960</span><br><span class="line">            51060</span><br><span class="line">            51119</span><br><span class="line">            51120</span><br><span class="line">            ...</span><br><span class="line">        comp.graphics/</span><br><span class="line">        comp.os.ms-windows.misc/</span><br><span class="line">        comp.sys.ibm.pc.hardware/</span><br><span class="line">        comp.sys.mac.hardware/</span><br><span class="line">        comp.windows.x/</span><br><span class="line">        misc.forsale/</span><br><span class="line">        rec.autos/</span><br><span class="line">        rec.motorcycles/</span><br><span class="line">        rec.sport.baseball/</span><br><span class="line">        rec.sport.hockey/</span><br><span class="line">        sci.crypt/</span><br><span class="line">        sci.electronics/</span><br><span class="line">        sci.med/</span><br><span class="line">        sci.space/</span><br><span class="line">        soc.religion.christian/</span><br><span class="line">        talk.politics.guns/</span><br><span class="line">        talk.politics.mideast/</span><br><span class="line">        talk.politics.misc/</span><br><span class="line">        talk.religion.misc/</span><br><span class="line">    20news-bydate-test/</span><br><span class="line">    20news-bydate-train/</span><br><span class="line">    20_newsgroups/</span><br></pre></td></tr></table></figure>
<h3 id="Segment"><a href="#Segment" class="headerlink" title="Segment"></a>Segment</h3><p>Segment 是数据集的不同部分</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 内置</span></span><br><span class="line">seg_name = <span class="string">"20news-18828"</span></span><br><span class="line">dataset_client = gas.get_dataset(<span class="string">"Newsgroups20"</span>)</span><br><span class="line">segment = Segment(seg_name, dataset_client)</span><br><span class="line"></span><br><span class="line">segment</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Segment("20news-18828") [</span></span><br><span class="line"><span class="string">  RemoteData("alt.atheism_49960.txt")(...),</span></span><br><span class="line"><span class="string">  RemoteData("alt.atheism_51060.txt")(...),</span></span><br><span class="line"><span class="string">  RemoteData("alt.atheism_51119.txt")(...),</span></span><br><span class="line"><span class="string">  RemoteData("alt.atheism_51120.txt")(...),</span></span><br><span class="line"><span class="string">  RemoteData("alt.atheism_51121.txt")(...),</span></span><br><span class="line"><span class="string">  RemoteData("alt.atheism_51122.txt")(...),</span></span><br><span class="line"><span class="string">  RemoteData("alt.atheism_51123.txt")(...),</span></span><br><span class="line"><span class="string">  RemoteData("alt.atheism_51124.txt")(...),</span></span><br><span class="line"><span class="string">  RemoteData("alt.atheism_51125.txt")(...),</span></span><br><span class="line"><span class="string">  RemoteData("alt.atheism_51126.txt")(...),</span></span><br><span class="line"><span class="string">  RemoteData("alt.atheism_51127.txt")(...),</span></span><br><span class="line"><span class="string">  RemoteData("alt.atheism_51128.txt")(...),</span></span><br><span class="line"><span class="string">  RemoteData("alt.atheism_51130.txt")(...),</span></span><br><span class="line"><span class="string">  RemoteData("alt.atheism_51131.txt")(...),</span></span><br><span class="line"><span class="string">  ... (18813 items are folded),</span></span><br><span class="line"><span class="string">  RemoteData("talk.religion.misc_84570.txt")(...)</span></span><br><span class="line"><span class="string">]</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">segment[<span class="number">0</span>]</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">RemoteData("alt.atheism_49960.txt")(</span></span><br><span class="line"><span class="string">  (label): Label(</span></span><br><span class="line"><span class="string">    (classification): Classification(</span></span><br><span class="line"><span class="string">      (category): 'alt.atheism'</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">  )</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 本地</span></span><br><span class="line">seg = ds[<span class="string">"20news-18828"</span>]</span><br><span class="line">seg[<span class="number">0</span>]</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Data("/path/to/data/20news-18828/alt.atheism/49960")(</span></span><br><span class="line"><span class="string">  (label): Label(</span></span><br><span class="line"><span class="string">    (classification): Classification(</span></span><br><span class="line"><span class="string">      (category): 'alt.atheism'</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">  )</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>
<h3 id="Data"><a href="#Data" class="headerlink" title="Data"></a>Data</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 单个样本</span></span><br><span class="line">ele = seg[<span class="number">0</span>]</span><br><span class="line">type(ele) <span class="comment"># tensorbay.dataset.data.Data</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 标签</span></span><br><span class="line">ele.label</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Label(</span></span><br><span class="line"><span class="string">  (classification): Classification(</span></span><br><span class="line"><span class="string">    (category): 'alt.atheism'</span></span><br><span class="line"><span class="string">  )</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据</span></span><br><span class="line">ele.open().read()[:<span class="number">500</span>]</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">b'From: mathew &lt;mathew@mantis.co.uk&gt;\nSubject: Alt.Atheism FAQ: Atheist Resources\n\nArchive-name: atheism/resources\nAlt-atheism-archive-name: resources\nLast-modified: 11 December 1992\nVersion: 1.0\n\n                              Atheist Resources\n\n                      Addresses of Atheist Organizations\n\n                                     USA\n\nFREEDOM FROM RELIGION FOUNDATION\n\nDarwin fish bumper stickers and assorted other atheist paraphernalia are\navailable from the Freedom From Religion Foundatio'</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历数据集</span></span><br><span class="line"><span class="comment"># 每个 v 都是一个 ele 的 Data 实例</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> seg:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">i <span class="comment"># 18828</span></span><br><span class="line">type(v) <span class="comment"># tensorbay.dataset.data.Data</span></span><br></pre></td></tr></table></figure>
<h2 id="TextCNN"><a href="#TextCNN" class="headerlink" title="TextCNN"></a>TextCNN</h2><p>TextCNN 是 CNN 的 NLP 版本，来自 Kim 的 <a href="https://arxiv.org/abs/1408.5882" target="_blank" rel="noopener">[1408.5882] Convolutional Neural Networks for Sentence Classification</a></p>
<p>结构如下：</p>
<p><img src="http://qnimg.lovevivian.cn/paper-textcnn-1.jpg" alt=""></p>
<p>大致原理是使用多个不同大小的 filter（也叫 kernel） 对文本进行特征提取，如上图所示：</p>
<ul>
<li>首先通过 Embedding 将输入的句子映射为一个 <code>n_seq * embed_size</code> 大小的张量（实际中一般还会有 batch_size）</li>
<li>使用 <code>(filter_size, embed_size)</code> 大小的 filter 在输入句子序列上平滑移动，这里使用不同的 padding 策略，会得到不同 size 的输出</li>
<li>由于有 <code>num_filters</code> 个输出通道，所以上面的输出会有 <code>num_filters</code> 个</li>
<li>使用 Max Pooling 或 Average Pooling，沿着序列方向得到结果，最终每个 filter 的输出 size 为 <code>num_filters</code></li>
<li>将不同 filter 的输出拼接后展开，作为句子的表征</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras <span class="keyword">as</span> tfk</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">text_cnn</span><span class="params">(config, inputs)</span>:</span></span><br><span class="line">    embed = tfk.layers.Embedding(</span><br><span class="line">        config.vocab_size, config.embed_size, input_length=config.max_len)(inputs)</span><br><span class="line">    embed = embed[:, :, :, <span class="keyword">None</span>]</span><br><span class="line">    pool_outputs = []</span><br><span class="line">    <span class="keyword">for</span> filter_size <span class="keyword">in</span> map(int, config.filter_sizes.split(<span class="string">','</span>)):</span><br><span class="line">        <span class="comment"># 卷积</span></span><br><span class="line">        conv = tfk.layers.Conv2D(</span><br><span class="line">            config.num_filters, </span><br><span class="line">            kernel_size=(filter_size, config.embed_size), </span><br><span class="line">            strides=(<span class="number">1</span>, <span class="number">1</span>), </span><br><span class="line">            padding=<span class="string">'valid'</span>,</span><br><span class="line">            activation=<span class="string">"relu"</span>,</span><br><span class="line">        )(embed)</span><br><span class="line">        <span class="comment"># Max Pooling</span></span><br><span class="line">        pool = tfk.layers.MaxPool2D(</span><br><span class="line">            pool_size=(config.max_len - filter_size + <span class="number">1</span>, <span class="number">1</span>), </span><br><span class="line">            strides=(<span class="number">1</span>, <span class="number">1</span>), </span><br><span class="line">            padding=<span class="string">'valid'</span>)(conv)</span><br><span class="line">        pool_outputs.append(pool)</span><br><span class="line"></span><br><span class="line">    z = tfk.layers.concatenate(pool_outputs, axis=<span class="number">-1</span>)</span><br><span class="line">    z = tf.squeeze(z, [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">    z = tfk.layers.Dropout(config.dropout)(z)</span><br><span class="line">    <span class="keyword">return</span> z</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> pnlp <span class="keyword">import</span> Dict</span><br><span class="line">config = Dict(&#123;</span><br><span class="line">    <span class="string">"vocab_size"</span>: <span class="number">21128</span>,</span><br><span class="line">    <span class="string">"embed_size"</span>: <span class="number">256</span>,</span><br><span class="line">    <span class="string">"max_len"</span>: <span class="number">512</span>,</span><br><span class="line">    <span class="string">"num_filters"</span>: <span class="number">128</span>,</span><br><span class="line">    <span class="string">"filter_sizes"</span>: <span class="string">"2,3,4"</span>,</span><br><span class="line">    <span class="string">"dropout"</span>: <span class="number">0.1</span>,</span><br><span class="line">    <span class="string">"num_classes"</span>: <span class="number">20</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">z = text_cnn(config, tf.constant([[<span class="number">1</span>]*<span class="number">512</span>]))</span><br><span class="line">z.shape <span class="comment"># TensorShape([1, 384])</span></span><br></pre></td></tr></table></figure>
<h2 id="AllTogether"><a href="#AllTogether" class="headerlink" title="AllTogether"></a>AllTogether</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Union</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> pnlp</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> tensorflow.data <span class="keyword">import</span> Dataset</span><br><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> AutoTokenizer</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NewsGroupSegment</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        self, </span></span></span><br><span class="line"><span class="function"><span class="params">        client: Union[str, GAS], </span></span></span><br><span class="line"><span class="function"><span class="params">        segment_name: str, </span></span></span><br><span class="line"><span class="function"><span class="params">        tokenizer_path: str, </span></span></span><br><span class="line"><span class="function"><span class="params">        label_file: str, </span></span></span><br><span class="line"><span class="function"><span class="params">        max_length: int = <span class="number">512</span></span></span></span><br><span class="line"><span class="function"><span class="params">    )</span>:</span></span><br><span class="line">        <span class="comment"># 使用公开数据</span></span><br><span class="line">        <span class="keyword">if</span> isinstance(client, GAS):</span><br><span class="line">            self.dataset = TensorBayDataset(<span class="string">"Newsgroups20"</span>, client)</span><br><span class="line">        <span class="comment"># 使用本地数据</span></span><br><span class="line">        <span class="keyword">elif</span> isinstance(client, str):</span><br><span class="line">            self.dataset = Newsgroups20(client)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">"Invalid dataset client"</span>)</span><br><span class="line">        self.segment = self.dataset[segment_name]</span><br><span class="line">        self.max_length = max_length</span><br><span class="line">        self.tokenizer = AutoTokenizer.from_pretrained(tokenizer_path)</span><br><span class="line">        labels = pnlp.read_lines(label_file)</span><br><span class="line">        self.category_to_index = dict(zip(labels, range(len(labels))))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> data <span class="keyword">in</span> self.segment:</span><br><span class="line">            <span class="keyword">with</span> data.open() <span class="keyword">as</span> fp:</span><br><span class="line">                txt = fp.read().decode(<span class="string">"utf8"</span>, errors=<span class="string">"ignore"</span>)</span><br><span class="line">                <span class="comment"># tokenize</span></span><br><span class="line">                ids = self.tokenizer.encode(</span><br><span class="line">                    txt, max_length=self.max_length, truncation=<span class="keyword">True</span>, padding=<span class="string">"max_length"</span></span><br><span class="line">                )</span><br><span class="line">                input_tensor = tf.convert_to_tensor(np.array(ids), dtype=tf.int32)</span><br><span class="line">            category = self.category_to_index[data.label.classification.category]</span><br><span class="line">            category_tensor = tf.convert_to_tensor(category, dtype=tf.int32)</span><br><span class="line">            <span class="keyword">yield</span> input_tensor, category_tensor</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_model</span><span class="params">(config, module)</span>:</span></span><br><span class="line">    inputs = tfk.Input(shape=(config.max_len, ))</span><br><span class="line">    z = module(config, inputs)</span><br><span class="line">    outputs = tfk.layers.Dense(config.num_classes, activation=<span class="string">'softmax'</span>)(z)</span><br><span class="line">    model = tfk.Model(inputs=inputs, outputs=outputs)</span><br><span class="line">    <span class="keyword">return</span> model</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 构建模型</span></span><br><span class="line">model = build_model(config, text_cnn)</span><br><span class="line">model.compile(</span><br><span class="line">    optimizer=tfk.optimizers.Adamax(learning_rate=<span class="number">1e-3</span>),</span><br><span class="line">    loss=tfk.losses.SparseCategoricalCrossentropy(),</span><br><span class="line">    metrics=[tfk.metrics.SparseCategoricalAccuracy()],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成训练数据</span></span><br><span class="line">max_len = <span class="number">512</span></span><br><span class="line">batch_size = <span class="number">32</span></span><br><span class="line">segment_name = <span class="string">"20news-18828"</span></span><br><span class="line">client = <span class="string">"./data/"</span>  <span class="comment"># 或者使用内置：GAS(token)</span></span><br><span class="line"><span class="comment"># bert 主要用于 tokenize，目录下只有 `config.json` 和 `vocab.txt`</span></span><br><span class="line">data = NewsGroupSegment(client, segment_name, <span class="string">"./bert/"</span>, <span class="string">"labels.txt"</span>, max_len)</span><br><span class="line">epochs = <span class="number">10</span></span><br><span class="line">steps_per_epoch = math.ceil(len(data.segment) / batch_size)</span><br><span class="line"></span><br><span class="line">dataset = Dataset.from_generator(</span><br><span class="line">    data,</span><br><span class="line">    output_signature=(</span><br><span class="line">        tf.TensorSpec(shape=(max_len, ), dtype=tf.float32),</span><br><span class="line">        tf.TensorSpec(shape=(), dtype=tf.int32),</span><br><span class="line">    ),</span><br><span class="line">).shuffle(buffer_size=len(data.segment), reshuffle_each_iteration=<span class="keyword">True</span>).batch(batch_size).repeat(epochs)</span><br></pre></td></tr></table></figure>
<p>根目录如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> tree . -L 2</span><br><span class="line">.</span><br><span class="line">├── bert</span><br><span class="line">│   ├── config.json</span><br><span class="line">│   └── vocab.txt</span><br><span class="line">├── data</span><br><span class="line">│   └── 20news-18828</span><br><span class="line">├── labels.txt</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model.fit(dataset, epochs=epochs, steps_per_epoch=steps_per_epoch)</span><br></pre></td></tr></table></figure>
<pre><code>Epoch 1/10
589/589 [==============================] - 391s 564ms/step - loss: 2.3371 - sparse_categorical_accuracy: 0.3687
Epoch 2/10
589/589 [==============================] - 411s 592ms/step - loss: 1.2920 - sparse_categorical_accuracy: 0.6325
Epoch 3/10
589/589 [==============================] - 480s 709ms/step - loss: 0.9563 - sparse_categorical_accuracy: 0.7256
Epoch 4/10
589/589 [==============================] - 490s 737ms/step - loss: 0.7665 - sparse_categorical_accuracy: 0.7844
Epoch 5/10
589/589 [==============================] - 547s 836ms/step - loss: 0.6326 - sparse_categorical_accuracy: 0.8221
Epoch 6/10
589/589 [==============================] - 368s 522ms/step - loss: 0.5288 - sparse_categorical_accuracy: 0.8528
Epoch 7/10
589/589 [==============================] - 435s 625ms/step - loss: 0.4422 - sparse_categorical_accuracy: 0.8812
Epoch 8/10
589/589 [==============================] - 494s 706ms/step - loss: 0.3728 - sparse_categorical_accuracy: 0.9026
Epoch 9/10
589/589 [==============================] - 679s 1s/step - loss: 0.3131 - sparse_categorical_accuracy: 0.9152
Epoch 10/10
589/589 [==============================] - 676s 976ms/step - loss: 0.2641 - sparse_categorical_accuracy: 0.9348
</code></pre><p>需要注意：</p>
<ul>
<li>数据集文件或 Segment 无法 shuffle 的，可以加载后 shuffle</li>
<li>数据加载比较慢，尤其是在线加载，可以先把文件 Load 到本地</li>
</ul>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>本文我们借助 TensorBay，使用 TextCNN 完成了简单的文本分类任务。TensorBay 本身并没有什么黑魔法，只是提供了一个统一管理数据的视角和工具，借助该工具，我们可以方便快捷地管理和使用数据集。</p>
<p>本文使用 Tensorflow 为例进行说明，TensorBay 也支持 PyTorch，使用方法大同小异，具体可以参考文档。</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="https://tensorbay-python-sdk.graviti.com/en/stable/integrations/tensorflow.html" target="_blank" rel="noopener">TensorFlow — TensorBay documentation</a></li>
<li><a href="http://qwone.com/~jason/20Newsgroups/" target="_blank" rel="noopener">Home Page for 20 Newsgroups Data Set</a></li>
</ul>

      
    </div><!-- .entry-content -->

    <footer class="entry-meta">
    <a href="/2021/09/21/NLP/2021-09-21-TensorBay-Intro/">
    <time datetime="2021-09-21T15:30:00.000Z" class="entry-date">
        2021-09-21
    </time>
</a>
    
  <span class="article-delim">&#8226;</span>
  <div class="article-category">
  <a class="article-category-link" href="/categories/Coding/">Coding</a>
  </div>

    
  <span class="article-delim">&#8226;</span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AI/">AI</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NLP/">NLP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TensorBay/">TensorBay</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Tensorflow/">Tensorflow</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TextCNN/">TextCNN</a></li></ul>

    </footer>
</article>


    
<nav class="nav-single">
    <h3 class="assistive-text">文章导航</h3>
    
        <span class="nav-previous"><a href="/2021/10/27/NLP/2021-10-27-Senta/" rel="prev"><span class="meta-nav">←</span> 浅析文本分类——情感分析与自然语言处理</a></span>
    
    
        <span class="nav-next"><a href="/2021/08/31/AI/2021-08-31-SL-CL-Dropout/" rel="next">在 TextCNN 上实验 Dropout 和对比学习 <span class="meta-nav">→</span></a></span>
    
</nav><!-- .nav-single -->







<div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_fbook" data-cmd="fbook" title="分享到Facebook"></a><a href="#" class="bds_twi" data-cmd="twi" title="分享到Twitter"></a><a href="#" class="bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_douban" data-cmd="douban" title="分享到豆瓣网"></a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a><a href="#" class="bds_evernotecn" data-cmd="evernotecn" title="分享到印象笔记"></a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"1","bdSize":"24"},"share":{},"image":{"viewList":["fbook","twi","linkedin","qzone","tsina","douban","weixin","evernotecn"],"viewText":"分享到：","viewSize":"16"}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?'];</script>

<section id="comment">
  <!-- 评论代码 -->
  <div id="gitalk-container"></div>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
  <script>
  const gitalk = new Gitalk({
    clientID: '0eb512031083d6e7edfb',
    clientSecret: 'e830808995dd813ca26fed50573760963457da37',
    repo: 'hscspring.github.io',
    owner: 'hscspring',
    admin: ['hscspring'],
    id: md5(location.pathname),
    distractionFreeMode: false
  })
  gitalk.render('gitalk-container')
  </script>
  <!-- 评论代码已完成 -->
</section>

</div></div>
        <div id="secondary" class="widget-area" role="complementary">
  
    
  <aside class="widget">
    <h3 class="widget-title">Categories</h3>
    <div class="widget-content">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Coding/">Coding</a><span class="category-list-count">70</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Feeling/">Feeling</a><span class="category-list-count">98</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Thinking/">Thinking</a><span class="category-list-count">21</span></li></ul>
    </div>
  </aside>

  
    
  <aside class="widget">
    <h3 class="widget-title">Music</h3>
    <div class="widget-content">
      <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=541131&auto=0&height=66"></iframe>
      <!-- 评论代码 -->
      <!-- <audio src="http://qnimg.lovevivian.cn/miss.mp3" controls="controls"
             style="width:100%">
        您的浏览器不支持 audio 标签。
      </audio> -->
    </div>
  </aside>

  
    
  <aside class="widget">
    <h3 class="widget-title">Recents</h3>
    <div class="widget-content">
      <ul>
        
          <li>
            <a href="/2022/09/11/Diary/2022-09-11-Passion/">只如初见的不只爱情</a>
          </li>
        
          <li>
            <a href="/2022/08/28/Paper/2022-08-28-FLAN/">FLAN：Fine-tuned Language Models are Zero-Shot Learners</a>
          </li>
        
          <li>
            <a href="/2022/07/17/Paper/2022-07-17-W2NER-Code/">W2NER 代码</a>
          </li>
        
          <li>
            <a href="/2022/07/02/Paper/2022-07-02-Cross-view-Brain-Decoding/">跨视角大脑解码</a>
          </li>
        
          <li>
            <a href="/2022/06/11/Paper/2022-06-11-W2NER/">统一NER为词词关系分类</a>
          </li>
        
      </ul>
    </div>
  </aside>

  
    
  <aside class="widget">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget-content tagcloud">
      <a href="/tags/AE/" style="font-size: 10px;">AE</a> <a href="/tags/AI/" style="font-size: 19.09px;">AI</a> <a href="/tags/ALBERT/" style="font-size: 10px;">ALBERT</a> <a href="/tags/AR/" style="font-size: 10px;">AR</a> <a href="/tags/AUC/" style="font-size: 10px;">AUC</a> <a href="/tags/Accuracy/" style="font-size: 10px;">Accuracy</a> <a href="/tags/Activation/" style="font-size: 10px;">Activation</a> <a href="/tags/Algorithm/" style="font-size: 13.64px;">Algorithm</a> <a href="/tags/Array/" style="font-size: 10px;">Array</a> <a href="/tags/Arrow/" style="font-size: 10px;">Arrow</a> <a href="/tags/Attention/" style="font-size: 12.73px;">Attention</a> <a href="/tags/Automatic-Speech-Processing/" style="font-size: 10px;">Automatic Speech Processing</a> <a href="/tags/Automation/" style="font-size: 10px;">Automation</a> <a href="/tags/BERT/" style="font-size: 17.27px;">BERT</a> <a href="/tags/BIO/" style="font-size: 10px;">BIO</a> <a href="/tags/BIOHD/" style="font-size: 10px;">BIOHD</a> <a href="/tags/BM25/" style="font-size: 10px;">BM25</a> <a href="/tags/BPE/" style="font-size: 10px;">BPE</a> <a href="/tags/Backtracking/" style="font-size: 10px;">Backtracking</a> <a href="/tags/Backward/" style="font-size: 10px;">Backward</a> <a href="/tags/Bahdanau-Attention/" style="font-size: 10px;">Bahdanau Attention</a> <a href="/tags/Bart/" style="font-size: 10px;">Bart</a> <a href="/tags/Bayes/" style="font-size: 10px;">Bayes</a> <a href="/tags/Beam-Search/" style="font-size: 10px;">Beam Search</a> <a href="/tags/Bert-Flow/" style="font-size: 10px;">Bert-Flow</a> <a href="/tags/Bi-LSTM/" style="font-size: 10px;">Bi-LSTM</a> <a href="/tags/Biasing/" style="font-size: 10px;">Biasing</a> <a href="/tags/Binary-Search/" style="font-size: 11.82px;">Binary Search</a> <a href="/tags/Blending/" style="font-size: 10px;">Blending</a> <a href="/tags/Brain/" style="font-size: 10px;">Brain</a> <a href="/tags/Brain-Decoding/" style="font-size: 10px;">Brain Decoding</a> <a href="/tags/Bridge/" style="font-size: 10px;">Bridge</a> <a href="/tags/Business/" style="font-size: 11.82px;">Business</a> <a href="/tags/C/" style="font-size: 10.91px;">C</a> <a href="/tags/C4/" style="font-size: 10px;">C4</a> <a href="/tags/CCG/" style="font-size: 10.91px;">CCG</a> <a href="/tags/CE-BERT/" style="font-size: 10px;">CE BERT</a> <a href="/tags/CFG/" style="font-size: 10px;">CFG</a> <a href="/tags/CKY/" style="font-size: 10px;">CKY</a> <a href="/tags/CNN/" style="font-size: 10px;">CNN</a> <a href="/tags/CRF/" style="font-size: 10px;">CRF</a> <a href="/tags/CS/" style="font-size: 10px;">CS</a> <a href="/tags/CYK/" style="font-size: 10px;">CYK</a> <a href="/tags/Calculus/" style="font-size: 10px;">Calculus</a> <a href="/tags/Camera/" style="font-size: 10px;">Camera</a> <a href="/tags/Catalan/" style="font-size: 10px;">Catalan</a> <a href="/tags/ChatBot/" style="font-size: 10px;">ChatBot</a> <a href="/tags/Chi2/" style="font-size: 10px;">Chi2</a> <a href="/tags/Chunking/" style="font-size: 10px;">Chunking</a> <a href="/tags/Classification/" style="font-size: 10.91px;">Classification</a> <a href="/tags/Cognition/" style="font-size: 10.91px;">Cognition</a> <a href="/tags/Collaborative-Filtering/" style="font-size: 10px;">Collaborative Filtering</a> <a href="/tags/Collins-Parser/" style="font-size: 10px;">Collins Parser</a> <a href="/tags/Computational-Linguistics/" style="font-size: 10px;">Computational Linguistics</a> <a href="/tags/Computer/" style="font-size: 10px;">Computer</a> <a href="/tags/Computer-Science/" style="font-size: 12.73px;">Computer Science</a> <a href="/tags/Confusing-Labels/" style="font-size: 10px;">Confusing Labels</a> <a href="/tags/Context-Free-Grammars/" style="font-size: 10px;">Context-Free Grammars</a> <a href="/tags/Contrastive-Learning/" style="font-size: 10px;">Contrastive-Learning</a> <a href="/tags/Coordinate-Ascent/" style="font-size: 10px;">Coordinate Ascent</a> <a href="/tags/Cosine/" style="font-size: 10.91px;">Cosine</a> <a href="/tags/Cosine-Similarity/" style="font-size: 10px;">Cosine Similarity</a> <a href="/tags/Cross-Entropy/" style="font-size: 10px;">Cross Entropy</a> <a href="/tags/Cross-brackets/" style="font-size: 10px;">Cross-brackets</a> <a href="/tags/Cross-view/" style="font-size: 10px;">Cross-view</a> <a href="/tags/Ctrl/" style="font-size: 10px;">Ctrl</a> <a href="/tags/Culture/" style="font-size: 10px;">Culture</a> <a href="/tags/DA/" style="font-size: 10px;">DA</a> <a href="/tags/DB/" style="font-size: 10.91px;">DB</a> <a href="/tags/DNN/" style="font-size: 10px;">DNN</a> <a href="/tags/DP/" style="font-size: 10px;">DP</a> <a href="/tags/Data-Augmentation/" style="font-size: 10px;">Data Augmentation</a> <a href="/tags/Data-Clearing/" style="font-size: 10px;">Data Clearing</a> <a href="/tags/Data-Enhancement/" style="font-size: 10px;">Data Enhancement</a> <a href="/tags/Data-Preprocess/" style="font-size: 10px;">Data Preprocess</a> <a href="/tags/Data-Science/" style="font-size: 14.55px;">Data Science</a> <a href="/tags/Data-Structure/" style="font-size: 16.36px;">Data Structure</a> <a href="/tags/Database/" style="font-size: 10px;">Database</a> <a href="/tags/DeBERTa/" style="font-size: 10px;">DeBERTa</a> <a href="/tags/Debiasing/" style="font-size: 10px;">Debiasing</a> <a href="/tags/Decoder/" style="font-size: 10px;">Decoder</a> <a href="/tags/Decoding/" style="font-size: 10px;">Decoding</a> <a href="/tags/Deep/" style="font-size: 10px;">Deep</a> <a href="/tags/DeepGraph/" style="font-size: 10px;">DeepGraph</a> <a href="/tags/DeepLearning/" style="font-size: 12.73px;">DeepLearning</a> <a href="/tags/Dependence/" style="font-size: 10px;">Dependence</a> <a href="/tags/Diary/" style="font-size: 12.73px;">Diary</a> <a href="/tags/Disentangled-Attention/" style="font-size: 10px;">Disentangled Attention</a> <a href="/tags/DistilBERT/" style="font-size: 10px;">DistilBERT</a> <a href="/tags/Distillation/" style="font-size: 10px;">Distillation</a> <a href="/tags/Django/" style="font-size: 10px;">Django</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/Docker-Compose/" style="font-size: 10px;">Docker-Compose</a> <a href="/tags/Dockerfile/" style="font-size: 10px;">Dockerfile</a> <a href="/tags/Dropout/" style="font-size: 10.91px;">Dropout</a> <a href="/tags/Dynamic-Mask/" style="font-size: 10px;">Dynamic-Mask</a> <a href="/tags/EDA/" style="font-size: 10px;">EDA</a> <a href="/tags/EMD/" style="font-size: 10px;">EMD</a> <a href="/tags/ERNIE/" style="font-size: 10px;">ERNIE</a> <a href="/tags/Economics/" style="font-size: 10px;">Economics</a> <a href="/tags/Edit-Distance/" style="font-size: 10px;">Edit Distance</a> <a href="/tags/Efficient-DeepLearning/" style="font-size: 10px;">Efficient-DeepLearning</a> <a href="/tags/Elasticsearch/" style="font-size: 10px;">Elasticsearch</a> <a href="/tags/Electra/" style="font-size: 10px;">Electra</a> <a href="/tags/Elixir/" style="font-size: 10.91px;">Elixir</a> <a href="/tags/Ellipsis/" style="font-size: 10px;">Ellipsis</a> <a href="/tags/Embedding/" style="font-size: 11.82px;">Embedding</a> <a href="/tags/Embeddings/" style="font-size: 10.91px;">Embeddings</a> <a href="/tags/Encoder/" style="font-size: 10px;">Encoder</a> <a href="/tags/Entropy/" style="font-size: 10.91px;">Entropy</a> <a href="/tags/Evaluation/" style="font-size: 10.91px;">Evaluation</a> <a href="/tags/ExT5/" style="font-size: 10px;">ExT5</a> <a href="/tags/F1/" style="font-size: 10px;">F1</a> <a href="/tags/FDW/" style="font-size: 10px;">FDW</a> <a href="/tags/FLAN/" style="font-size: 10px;">FLAN</a> <a href="/tags/FSM/" style="font-size: 10px;">FSM</a> <a href="/tags/Faith/" style="font-size: 10px;">Faith</a> <a href="/tags/Feature-Engineering/" style="font-size: 10px;">Feature Engineering</a> <a href="/tags/Feature-based/" style="font-size: 10px;">Feature-based</a> <a href="/tags/Few-Shot/" style="font-size: 10px;">Few-Shot</a> <a href="/tags/Fine-tuning/" style="font-size: 10px;">Fine-tuning</a> <a href="/tags/Formal-Grammars/" style="font-size: 11.82px;">Formal Grammars</a> <a href="/tags/Forward/" style="font-size: 10px;">Forward</a> <a href="/tags/Full-Text-Search/" style="font-size: 10px;">Full-Text-Search</a> <a href="/tags/Function-Syntax/" style="font-size: 10px;">Function Syntax</a> <a href="/tags/Funk-MF/" style="font-size: 10px;">Funk MF</a> <a href="/tags/Funnel-Transformer/" style="font-size: 10px;">Funnel Transformer</a> <a href="/tags/GBTD/" style="font-size: 10px;">GBTD</a> <a href="/tags/GELU/" style="font-size: 10px;">GELU</a> <a href="/tags/GPT-2/" style="font-size: 10px;">GPT-2</a> <a href="/tags/GPU/" style="font-size: 10px;">GPU</a> <a href="/tags/GRU/" style="font-size: 10px;">GRU</a> <a href="/tags/GSG/" style="font-size: 10px;">GSG</a> <a href="/tags/Gan/" style="font-size: 10px;">Gan</a> <a href="/tags/Garden-path/" style="font-size: 10px;">Garden-path</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Glow/" style="font-size: 10px;">Glow</a> <a href="/tags/Graceful-Shutdown/" style="font-size: 10px;">Graceful Shutdown</a> <a href="/tags/Gradient-Descent/" style="font-size: 10px;">Gradient Descent</a> <a href="/tags/Graph/" style="font-size: 10.91px;">Graph</a> <a href="/tags/GraphQL/" style="font-size: 10.91px;">GraphQL</a> <a href="/tags/Grid-Grammar/" style="font-size: 10px;">Grid Grammar</a> <a href="/tags/Growth/" style="font-size: 10px;">Growth</a> <a href="/tags/HMM/" style="font-size: 10.91px;">HMM</a> <a href="/tags/Hard-SVM/" style="font-size: 10px;">Hard-SVM</a> <a href="/tags/Hinge-Loss/" style="font-size: 10px;">Hinge Loss</a> <a href="/tags/Hope/" style="font-size: 10px;">Hope</a> <a href="/tags/Host-only/" style="font-size: 10px;">Host-only</a> <a href="/tags/IE/" style="font-size: 10px;">IE</a> <a href="/tags/IQR/" style="font-size: 10px;">IQR</a> <a href="/tags/Imbalance-Data/" style="font-size: 10px;">Imbalance Data</a> <a href="/tags/Impossible-Triangle/" style="font-size: 10px;">Impossible-Triangle</a> <a href="/tags/Industry/" style="font-size: 10px;">Industry</a> <a href="/tags/Information-Extraction/" style="font-size: 10px;">Information Extraction</a> <a href="/tags/Information-Theory/" style="font-size: 10px;">Information Theory</a> <a href="/tags/Isolation-Forest/" style="font-size: 10px;">Isolation Forest</a> <a href="/tags/ItemCF/" style="font-size: 10px;">ItemCF</a> <a href="/tags/Jaccard/" style="font-size: 10px;">Jaccard</a> <a href="/tags/Java/" style="font-size: 10px;">Java</a> <a href="/tags/Jax/" style="font-size: 10px;">Jax</a> <a href="/tags/Job/" style="font-size: 10px;">Job</a> <a href="/tags/Jupyter/" style="font-size: 10px;">Jupyter</a> <a href="/tags/KKT/" style="font-size: 10px;">KKT</a> <a href="/tags/KS/" style="font-size: 10px;">KS</a> <a href="/tags/Kernel/" style="font-size: 10px;">Kernel</a> <a href="/tags/Kernel-Function/" style="font-size: 10px;">Kernel Function</a> <a href="/tags/Kernel-Method/" style="font-size: 10px;">Kernel Method</a> <a href="/tags/Keyword/" style="font-size: 10px;">Keyword</a> <a href="/tags/Knowledge-Graph/" style="font-size: 10.91px;">Knowledge Graph</a> <a href="/tags/LM/" style="font-size: 10.91px;">LM</a> <a href="/tags/LOF/" style="font-size: 10px;">LOF</a> <a href="/tags/LR/" style="font-size: 10px;">LR</a> <a href="/tags/LSTM/" style="font-size: 10px;">LSTM</a> <a href="/tags/Language-Model/" style="font-size: 10.91px;">Language Model</a> <a href="/tags/Lexical-Semantics/" style="font-size: 10px;">Lexical Semantics</a> <a href="/tags/Lexicalism/" style="font-size: 10px;">Lexicalism</a> <a href="/tags/Lexicalized-CFG/" style="font-size: 10px;">Lexicalized CFG</a> <a href="/tags/Lexicalized-Grammars/" style="font-size: 10px;">Lexicalized Grammars</a> <a href="/tags/Life/" style="font-size: 10px;">Life</a> <a href="/tags/Linear-Algebra/" style="font-size: 10px;">Linear Algebra</a> <a href="/tags/Linear-Sturcture/" style="font-size: 10px;">Linear Sturcture</a> <a href="/tags/Linked-List/" style="font-size: 10px;">Linked List</a> <a href="/tags/LinkedList/" style="font-size: 10.91px;">LinkedList</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/Logistic-Regression/" style="font-size: 10px;">Logistic Regression</a> <a href="/tags/Lucene/" style="font-size: 10px;">Lucene</a> <a href="/tags/Luong-Attention/" style="font-size: 10px;">Luong Attention</a> <a href="/tags/MEMM/" style="font-size: 10px;">MEMM</a> <a href="/tags/MF/" style="font-size: 10px;">MF</a> <a href="/tags/MTL/" style="font-size: 11.82px;">MTL</a> <a href="/tags/Machine/" style="font-size: 10px;">Machine</a> <a href="/tags/Machine-Learning/" style="font-size: 14.55px;">Machine Learning</a> <a href="/tags/Machine-Translation/" style="font-size: 10px;">Machine Translation</a> <a href="/tags/Manacher/" style="font-size: 10px;">Manacher</a> <a href="/tags/Managemnt/" style="font-size: 11.82px;">Managemnt</a> <a href="/tags/MarkBERT/" style="font-size: 10px;">MarkBERT</a> <a href="/tags/Markov/" style="font-size: 10px;">Markov</a> <a href="/tags/Materialized-Views/" style="font-size: 10px;">Materialized Views</a> <a href="/tags/Math/" style="font-size: 10.91px;">Math</a> <a href="/tags/Matplotlib/" style="font-size: 10px;">Matplotlib</a> <a href="/tags/Matrix-Factorization/" style="font-size: 10px;">Matrix Factorization</a> <a href="/tags/Median/" style="font-size: 10px;">Median</a> <a href="/tags/Meta-Learning/" style="font-size: 10px;">Meta Learning</a> <a href="/tags/Metric/" style="font-size: 10px;">Metric</a> <a href="/tags/Minimum-Edit-Distance/" style="font-size: 10px;">Minimum Edit Distance</a> <a href="/tags/Minkowski/" style="font-size: 10px;">Minkowski</a> <a href="/tags/Model-Evaluation/" style="font-size: 10px;">Model Evaluation</a> <a href="/tags/Module/" style="font-size: 10px;">Module</a> <a href="/tags/Multi-Head-Attention/" style="font-size: 10px;">Multi-Head Attention</a> <a href="/tags/Multitask/" style="font-size: 10px;">Multitask</a> <a href="/tags/Multiway-Tree/" style="font-size: 10px;">Multiway Tree</a> <a href="/tags/NAT/" style="font-size: 10px;">NAT</a> <a href="/tags/NER/" style="font-size: 13.64px;">NER</a> <a href="/tags/NLG/" style="font-size: 10.91px;">NLG</a> <a href="/tags/NLM/" style="font-size: 10.91px;">NLM</a> <a href="/tags/NLP/" style="font-size: 20px;">NLP</a> <a href="/tags/NLU/" style="font-size: 10px;">NLU</a> <a href="/tags/NMT/" style="font-size: 10px;">NMT</a> <a href="/tags/NNW/" style="font-size: 10.91px;">NNW</a> <a href="/tags/Naive-Bayes/" style="font-size: 10px;">Naive Bayes</a> <a href="/tags/Neo4j/" style="font-size: 10px;">Neo4j</a> <a href="/tags/Network/" style="font-size: 10px;">Network</a> <a href="/tags/Ngram/" style="font-size: 10.91px;">Ngram</a> <a href="/tags/Normalizing-Flow/" style="font-size: 10px;">Normalizing Flow</a> <a href="/tags/NumPy/" style="font-size: 10px;">NumPy</a> <a href="/tags/Numba/" style="font-size: 10px;">Numba</a> <a href="/tags/Numpy/" style="font-size: 10px;">Numpy</a> <a href="/tags/Occupation/" style="font-size: 10px;">Occupation</a> <a href="/tags/Orientation/" style="font-size: 10px;">Orientation</a> <a href="/tags/P-R/" style="font-size: 10px;">P-R</a> <a href="/tags/PCCG/" style="font-size: 10px;">PCCG</a> <a href="/tags/PCFG/" style="font-size: 10px;">PCFG</a> <a href="/tags/PEGASUS/" style="font-size: 10px;">PEGASUS</a> <a href="/tags/PLM/" style="font-size: 10.91px;">PLM</a> <a href="/tags/PPMI/" style="font-size: 10px;">PPMI</a> <a href="/tags/PTM/" style="font-size: 10px;">PTM</a> <a href="/tags/PageRank/" style="font-size: 10px;">PageRank</a> <a href="/tags/Palindromic/" style="font-size: 10px;">Palindromic</a> <a href="/tags/Pandarallel/" style="font-size: 10px;">Pandarallel</a> <a href="/tags/Pandas/" style="font-size: 10.91px;">Pandas</a> <a href="/tags/Partial-Parsing/" style="font-size: 10px;">Partial Parsing</a> <a href="/tags/Passion/" style="font-size: 10px;">Passion</a> <a href="/tags/Pearson/" style="font-size: 10px;">Pearson</a> <a href="/tags/Philosophy/" style="font-size: 10.91px;">Philosophy</a> <a href="/tags/Phrase-Structure-Grammar/" style="font-size: 10px;">Phrase Structure Grammar</a> <a href="/tags/Phrase-Structure-Grammars/" style="font-size: 10px;">Phrase Structure Grammars</a> <a href="/tags/PoS/" style="font-size: 10px;">PoS</a> <a href="/tags/Polars/" style="font-size: 10px;">Polars</a> <a href="/tags/Pooling/" style="font-size: 10px;">Pooling</a> <a href="/tags/Position-Encoding/" style="font-size: 10px;">Position-Encoding</a> <a href="/tags/Postgres/" style="font-size: 10.91px;">Postgres</a> <a href="/tags/Pragmatic-Automatic-Processing/" style="font-size: 10px;">Pragmatic Automatic Processing</a> <a href="/tags/Pre-Trained/" style="font-size: 10px;">Pre-Trained</a> <a href="/tags/Pre-Training/" style="font-size: 10px;">Pre-Training</a> <a href="/tags/Pre-training/" style="font-size: 10.91px;">Pre-training</a> <a href="/tags/Precision/" style="font-size: 10px;">Precision</a> <a href="/tags/Pretrain/" style="font-size: 10.91px;">Pretrain</a> <a href="/tags/Pretrained/" style="font-size: 10px;">Pretrained</a> <a href="/tags/Pretraining/" style="font-size: 10.91px;">Pretraining</a> <a href="/tags/Probabilistic-Grammar/" style="font-size: 10px;">Probabilistic Grammar</a> <a href="/tags/Probabilistic-Model/" style="font-size: 10px;">Probabilistic Model</a> <a href="/tags/Promote/" style="font-size: 10px;">Promote</a> <a href="/tags/Prompt/" style="font-size: 10.91px;">Prompt</a> <a href="/tags/ProtoBERT/" style="font-size: 10px;">ProtoBERT</a> <a href="/tags/Pruning/" style="font-size: 10px;">Pruning</a> <a href="/tags/Psychology/" style="font-size: 10.91px;">Psychology</a> <a href="/tags/PyPI/" style="font-size: 10px;">PyPI</a> <a href="/tags/Python/" style="font-size: 18.18px;">Python</a> <a href="/tags/QA/" style="font-size: 10px;">QA</a> <a href="/tags/Quant/" style="font-size: 10px;">Quant</a> <a href="/tags/Quantization/" style="font-size: 10px;">Quantization</a> <a href="/tags/Query/" style="font-size: 10px;">Query</a> <a href="/tags/Queue/" style="font-size: 10px;">Queue</a> <a href="/tags/R-Drop/" style="font-size: 10.91px;">R-Drop</a> <a href="/tags/RELU/" style="font-size: 10px;">RELU</a> <a href="/tags/RFE/" style="font-size: 10px;">RFE</a> <a href="/tags/RMSE/" style="font-size: 10px;">RMSE</a> <a href="/tags/RNN/" style="font-size: 10px;">RNN</a> <a href="/tags/ROC/" style="font-size: 10px;">ROC</a> <a href="/tags/RWD/" style="font-size: 10px;">RWD</a> <a href="/tags/Rank/" style="font-size: 10px;">Rank</a> <a href="/tags/RaspberryPi/" style="font-size: 10.91px;">RaspberryPi</a> <a href="/tags/Raspberrypi/" style="font-size: 10px;">Raspberrypi</a> <a href="/tags/Recall/" style="font-size: 10px;">Recall</a> <a href="/tags/Recommendation/" style="font-size: 13.64px;">Recommendation</a> <a href="/tags/Recursion/" style="font-size: 10.91px;">Recursion</a> <a href="/tags/Reformer/" style="font-size: 10px;">Reformer</a> <a href="/tags/Regex/" style="font-size: 10px;">Regex</a> <a href="/tags/Regular-Expression/" style="font-size: 10px;">Regular Expression</a> <a href="/tags/Reinforcement-Learning/" style="font-size: 10px;">Reinforcement Learning</a> <a href="/tags/Relationship-Extraction/" style="font-size: 10px;">Relationship Extraction</a> <a href="/tags/Representation/" style="font-size: 10.91px;">Representation</a> <a href="/tags/Reqular-Expressions/" style="font-size: 10px;">Reqular Expressions</a> <a href="/tags/Retrieving/" style="font-size: 10px;">Retrieving</a> <a href="/tags/RoBERTa/" style="font-size: 10px;">RoBERTa</a> <a href="/tags/Rotated-Sorted-Array/" style="font-size: 10px;">Rotated Sorted Array</a> <a href="/tags/Rust/" style="font-size: 15.45px;">Rust</a> <a href="/tags/SCFG/" style="font-size: 10px;">SCFG</a> <a href="/tags/SGD/" style="font-size: 10px;">SGD</a> <a href="/tags/SMO/" style="font-size: 10px;">SMO</a> <a href="/tags/SQL/" style="font-size: 10.91px;">SQL</a> <a href="/tags/SRN/" style="font-size: 10px;">SRN</a> <a href="/tags/SVD/" style="font-size: 10px;">SVD++</a> <a href="/tags/SVM/" style="font-size: 10.91px;">SVM</a> <a href="/tags/Seaborn/" style="font-size: 10px;">Seaborn</a> <a href="/tags/Search/" style="font-size: 10.91px;">Search</a> <a href="/tags/Segmentation/" style="font-size: 10px;">Segmentation</a> <a href="/tags/Self-Attention/" style="font-size: 11.82px;">Self-Attention</a> <a href="/tags/Semantic-Automatic-Processing/" style="font-size: 10px;">Semantic Automatic Processing</a> <a href="/tags/Semantic-Similarity/" style="font-size: 10px;">Semantic Similarity</a> <a href="/tags/Senta/" style="font-size: 10px;">Senta</a> <a href="/tags/Sentence-Representation/" style="font-size: 10px;">Sentence Representation</a> <a href="/tags/Sentence-Similarity/" style="font-size: 10px;">Sentence Similarity</a> <a href="/tags/Sentence-BERT/" style="font-size: 10px;">Sentence-BERT</a> <a href="/tags/Sentiment-Classification/" style="font-size: 10px;">Sentiment Classification</a> <a href="/tags/SentimentAnalysis/" style="font-size: 10px;">SentimentAnalysis</a> <a href="/tags/Siamese/" style="font-size: 10px;">Siamese</a> <a href="/tags/Sigmoid/" style="font-size: 10px;">Sigmoid</a> <a href="/tags/SimCSE/" style="font-size: 10.91px;">SimCSE</a> <a href="/tags/Similarity/" style="font-size: 10px;">Similarity</a> <a href="/tags/Simon/" style="font-size: 10px;">Simon</a> <a href="/tags/Simpson-Paradox/" style="font-size: 10px;">Simpson Paradox</a> <a href="/tags/Skill/" style="font-size: 10px;">Skill</a> <a href="/tags/Slide/" style="font-size: 10px;">Slide</a> <a href="/tags/Smoothing/" style="font-size: 10.91px;">Smoothing</a> <a href="/tags/Soft-SVM/" style="font-size: 10px;">Soft-SVM</a> <a href="/tags/Softmax/" style="font-size: 10px;">Softmax</a> <a href="/tags/Sort/" style="font-size: 10.91px;">Sort</a> <a href="/tags/Span/" style="font-size: 10px;">Span</a> <a href="/tags/Spell-Check/" style="font-size: 10px;">Spell Check</a> <a href="/tags/SqueezeBERT/" style="font-size: 10px;">SqueezeBERT</a> <a href="/tags/Stack/" style="font-size: 10px;">Stack</a> <a href="/tags/Stacking/" style="font-size: 10px;">Stacking</a> <a href="/tags/Statistics/" style="font-size: 10px;">Statistics</a> <a href="/tags/Stirling/" style="font-size: 10px;">Stirling</a> <a href="/tags/StratifiedKFold/" style="font-size: 10px;">StratifiedKFold</a> <a href="/tags/String/" style="font-size: 10.91px;">String</a> <a href="/tags/Style/" style="font-size: 10px;">Style</a> <a href="/tags/Substring/" style="font-size: 10px;">Substring</a> <a href="/tags/Summarization/" style="font-size: 10.91px;">Summarization</a> <a href="/tags/Supertagging/" style="font-size: 10px;">Supertagging</a> <a href="/tags/Swap/" style="font-size: 10px;">Swap</a> <a href="/tags/System/" style="font-size: 10.91px;">System</a> <a href="/tags/T5/" style="font-size: 10.91px;">T5</a> <a href="/tags/TF-IDF/" style="font-size: 10px;">TF-IDF</a> <a href="/tags/THW/" style="font-size: 10.91px;">THW</a> <a href="/tags/Tagging/" style="font-size: 10px;">Tagging</a> <a href="/tags/TanH/" style="font-size: 10px;">TanH</a> <a href="/tags/TensorBay/" style="font-size: 10px;">TensorBay</a> <a href="/tags/Tensorflow/" style="font-size: 10px;">Tensorflow</a> <a href="/tags/Test/" style="font-size: 10px;">Test</a> <a href="/tags/Text-Classification/" style="font-size: 10px;">Text Classification</a> <a href="/tags/Text-Generation/" style="font-size: 10px;">Text Generation</a> <a href="/tags/Text-Normalization/" style="font-size: 10px;">Text Normalization</a> <a href="/tags/TextCNN/" style="font-size: 10.91px;">TextCNN</a> <a href="/tags/TextRank/" style="font-size: 10px;">TextRank</a> <a href="/tags/Thought/" style="font-size: 10px;">Thought</a> <a href="/tags/Transformer/" style="font-size: 17.27px;">Transformer</a> <a href="/tags/Transformer-XL/" style="font-size: 10px;">Transformer-XL</a> <a href="/tags/Tree/" style="font-size: 10px;">Tree</a> <a href="/tags/Treebank/" style="font-size: 10px;">Treebank</a> <a href="/tags/Tuning/" style="font-size: 10px;">Tuning</a> <a href="/tags/Tutorial/" style="font-size: 10px;">Tutorial</a> <a href="/tags/Ubuntu/" style="font-size: 10px;">Ubuntu</a> <a href="/tags/UniLM/" style="font-size: 10px;">UniLM</a> <a href="/tags/Unity-Operation/" style="font-size: 10px;">Unity Operation</a> <a href="/tags/Unix/" style="font-size: 10px;">Unix</a> <a href="/tags/UserCF/" style="font-size: 10px;">UserCF</a> <a href="/tags/Vagrant/" style="font-size: 10px;">Vagrant</a> <a href="/tags/Valence/" style="font-size: 10px;">Valence</a> <a href="/tags/Vector-Semantics/" style="font-size: 10px;">Vector Semantics</a> <a href="/tags/Virtual-Network/" style="font-size: 10px;">Virtual Network</a> <a href="/tags/VirtualBox/" style="font-size: 10px;">VirtualBox</a> <a href="/tags/Visualization/" style="font-size: 10px;">Visualization</a> <a href="/tags/Viterbi/" style="font-size: 10.91px;">Viterbi</a> <a href="/tags/Vocabulary-Learning/" style="font-size: 10px;">Vocabulary Learning</a> <a href="/tags/Voting/" style="font-size: 10px;">Voting</a> <a href="/tags/W2NER/" style="font-size: 10.91px;">W2NER</a> <a href="/tags/WOE/" style="font-size: 10px;">WOE</a> <a href="/tags/Web-Server-Multithreaded-Server/" style="font-size: 10px;">Web Server Multithreaded Server</a> <a href="/tags/Wide/" style="font-size: 10px;">Wide</a> <a href="/tags/Word2vec/" style="font-size: 10px;">Word2vec</a> <a href="/tags/Work/" style="font-size: 10px;">Work</a> <a href="/tags/XLNet/" style="font-size: 10px;">XLNet</a> <a href="/tags/Z-Score/" style="font-size: 10px;">Z-Score</a> <a href="/tags/Zero-Short/" style="font-size: 10px;">Zero-Short</a> <a href="/tags/Zero-Shot/" style="font-size: 10px;">Zero-Shot</a> <a href="/tags/Zero-shot/" style="font-size: 10px;">Zero-shot</a> <a href="/tags/ZhouZhihua/" style="font-size: 10px;">ZhouZhihua</a> <a href="/tags/Zipf/" style="font-size: 10px;">Zipf</a> <a href="/tags/binning/" style="font-size: 10px;">binning</a> <a href="/tags/few-shot/" style="font-size: 10px;">few-shot</a> <a href="/tags/ffmpeg/" style="font-size: 10px;">ffmpeg</a> <a href="/tags/jpype/" style="font-size: 10px;">jpype</a> <a href="/tags/knowledge-Graph/" style="font-size: 10px;">knowledge Graph</a> <a href="/tags/motion/" style="font-size: 10px;">motion</a> <a href="/tags/node2vec/" style="font-size: 10px;">node2vec</a> <a href="/tags/ssh/" style="font-size: 10px;">ssh</a> <a href="/tags/str/" style="font-size: 10px;">str</a> <a href="/tags/vlc/" style="font-size: 10px;">vlc</a>
    </div>
  </aside>

  
</div>
      </div>
      <footer id="colophon" role="contentinfo">
    <p>&copy; 2022 Yam
    All rights reserved.</p>
    <p>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></p>
    
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <!-- <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span> -->
    <!-- <span id="busuanzi_container_page_pv">本文总阅读量<span id="busuanzi_value_page_pv"></span>次</span> -->
    <!-- <span id="busuanzi_container_site_uv">本站访客数<span id="busuanzi_value_site_uv"></span>人次</span> -->

</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

<script src="/js/navigation.js"></script>

<div id="bg"></div>

  </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>